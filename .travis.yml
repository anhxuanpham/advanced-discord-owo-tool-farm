language: node_js
node_js:
  - "20"

branches:
  only:
    - main

before_install:
  # Decode SSH key from base64 environment variable
  - echo "$DEPLOY_KEY_BASE64" | base64 -d > ~/.ssh/deploy_key
  - chmod 600 ~/.ssh/deploy_key
  - echo -e "Host *\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
  - eval $(ssh-agent -s)
  - ssh-add ~/.ssh/deploy_key

script:
  - echo "Build check passed"

deploy:
  provider: script
  script: bash deploy.sh
  on:
    branch: main
  skip_cleanup: true
